{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/gaelc/Desktop/examenIngWeb/gael/gael/frontend/src/components/multimedia/Media.tsx"],"sourcesContent":["\"use client\";\r\n\r\ntype MediaProps = {\r\n  url: string;\r\n  width?: number;\r\n  height?: number;\r\n};\r\n// Detalles: width=384 === w-96 y height=256 === h-64\r\n\r\nexport default function Media({ url, width, height }: MediaProps) {\r\n  //Comprobamos si es video por su formato y permitimos luego la previsualización.\r\n  const isVideo = /\\.(mp4|mov|webm|avi|mkv)$/i.test(url) || url.includes('video/upload') || url.startsWith('data:video/');\r\n  const componentSize = width && height ? \"\" : \"w-96 h-64\";\r\n  \r\n  return (\r\n    <div className={`${componentSize} bg-gray-100 rounded-lg overflow-hidden shadow-md`}>\r\n      {isVideo ? (\r\n        <video src={url} className=\"w-full h-full object-cover\" controls preload=\"metadata\" playsInline />\r\n      ) : (\r\n        <img src={url} alt=\"media\" className=\"w-full h-full object-cover\" />\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;;AASe,SAAS,MAAM,EAAE,GAAG,EAAE,KAAK,EAAE,MAAM,EAAc;IAC9D,gFAAgF;IAChF,MAAM,UAAU,6BAA6B,IAAI,CAAC,QAAQ,IAAI,QAAQ,CAAC,mBAAmB,IAAI,UAAU,CAAC;IACzG,MAAM,gBAAgB,SAAS,SAAS,KAAK;IAE7C,qBACE,6LAAC;QAAI,WAAW,GAAG,cAAc,iDAAiD,CAAC;kBAChF,wBACC,6LAAC;YAAM,KAAK;YAAK,WAAU;YAA6B,QAAQ;YAAC,SAAQ;YAAW,WAAW;;;;;iCAE/F,6LAAC;YAAI,KAAK;YAAK,KAAI;YAAQ,WAAU;;;;;;;;;;;AAI7C;KAdwB"}},
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/gaelc/Desktop/examenIngWeb/gael/gael/frontend/src/app/multimedia/upload/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState, useCallback } from \"react\";\r\nimport Media from \"../../../components/multimedia/Media\";\r\n\r\nconst MAX_FILES = 5;\r\n\r\nexport default function UploadPage() {\r\n  const [files, setFiles] = useState<File[]>([]); //Gestionar\r\n  const [previews, setPreviews] = useState<string[]>([]);\r\n  const [urls, setUrls] = useState<string[]>([]);\r\n  const [uploading, setUploading] = useState(false);\r\n\r\n  const handleFileChange = useCallback((e: React.ChangeEvent<HTMLInputElement>) => {\r\n    if (e.target.files) {\r\n      //Recalculamos cuantos archivos tenemos y que no supere máximo\r\n      const newFiles = Array.from(e.target.files);\r\n      if (files.length + newFiles.length > MAX_FILES) {\r\n        alert(`Máximo ${MAX_FILES} archivos`);\r\n        return;\r\n      }\r\n\r\n      //Seteamos nuevo files.\r\n      setFiles(prev => [...prev, ...newFiles]);\r\n\r\n      //Añadimos para previsualizar los files.\r\n      newFiles.forEach(file => {\r\n        const reader = new FileReader();\r\n        reader.onloadend = () => {\r\n          setPreviews(prev => [...prev, reader.result as string]);\r\n        };\r\n        reader.readAsDataURL(file);\r\n      });\r\n    }\r\n  }, [files.length]);\r\n\r\n  const removeFile = (index: number) => {\r\n    setFiles(prev => prev.filter((_, i) => i !== index));\r\n    setPreviews(prev => prev.filter((_, i) => i !== index));\r\n  };\r\n\r\n  const handleUpload = async () => {\r\n    if (!files.length) return;\r\n    setUploading(true);\r\n\r\n    const cloudName = process.env.NEXT_PUBLIC_CLOUDINARY_CLOUD_NAME!;\r\n    const uploadPreset = process.env.NEXT_PUBLIC_CLOUDINARY_UPLOAD_PRESET!;\r\n\r\n    const uploadPromises = files.map(async (file) => {\r\n      const formData = new FormData();\r\n      formData.append(\"file\", file);\r\n      formData.append(\"upload_preset\", uploadPreset);\r\n\r\n      try {\r\n        const res = await fetch(`https://api.cloudinary.com/v1_1/${cloudName}/auto/upload`, {\r\n          method: \"POST\",\r\n          body: formData,\r\n        });\r\n        const data = await res.json();\r\n        return data.secure_url;\r\n      } catch {\r\n        return null;\r\n      }\r\n    });\r\n\r\n    const results = await Promise.all(uploadPromises);\r\n    const successfulUrls = results.filter(Boolean) as string[];\r\n    setUrls(prev => [...prev, ...successfulUrls]);\r\n\r\n    setFiles([]);\r\n    setPreviews([]);\r\n    setUploading(false);\r\n  };\r\n\r\n  return (\r\n    <div className=\"p-8 max-w-4xl mx-auto space-y-6\">\r\n      <h1 className=\"text-2xl font-bold\">Subir a Cloudinary (Máx {MAX_FILES})</h1>\r\n\r\n      {/* Input y botón */}\r\n      <div className=\"space-y-4 p-6 bg-gray-50 rounded-lg\">\r\n        <input\r\n          type=\"file\"\r\n          multiple\r\n          accept=\"image/*,video/*\"\r\n          onChange={handleFileChange}\r\n          className=\"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100\"\r\n        />\r\n\r\n        <h1 className=\"text-sm text-gray-600\">Archivos seleccionados: {files.length}/{MAX_FILES}</h1>\r\n      </div>\r\n\r\n      {/* Previsualización */}\r\n      {previews.length > 0 && (\r\n        <div>\r\n          <p className=\"mb-4 font-medium\">Previsualización:</p>\r\n\r\n          <div className=\"flex flex-wrap gap-3\">\r\n            {previews.map((preview, index) => {\r\n              const isVideo = preview.startsWith(\"data:video\");\r\n\r\n              return (\r\n                <div\r\n                  key={index}\r\n                  className=\"relative w-40 h-40 rounded-md overflow-hidden group\"\r\n                >\r\n                  {isVideo ? (\r\n                    <video\r\n                      src={preview}\r\n                      className=\"w-full h-full object-contain\"\r\n                      preload=\"metadata\"\r\n                      autoPlay\r\n                      controls={false}\r\n                      onMouseEnter={(e) => (e.currentTarget.controls = true)}\r\n                      onMouseLeave={(e) => (e.currentTarget.controls = false)}\r\n                    />\r\n                  ) : (\r\n                    <img\r\n                      src={preview}\r\n                      alt={`preview-${index}`}\r\n                      className=\"w-full h-full object-contain\"\r\n                    />\r\n                  )}\r\n\r\n                  <button\r\n                    onClick={() => removeFile(index)}\r\n                    className=\"absolute top-1 right-1 bg-red-500 text-white p-1 rounded-full text-xs shadow-md opacity-0 group-hover:opacity-100 transition-all\"\r\n                  >\r\n                    ✕\r\n                  </button>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      <button\r\n        onClick={handleUpload}\r\n        disabled={!files.length || uploading}\r\n        className=\"w-full py-2 px-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 flex items-center justify-center gap-2\"\r\n      >\r\n        {uploading ? (\r\n          <>\r\n            <div className=\"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin\" />\r\n            Subiendo {files.length} archivos...\r\n          </>\r\n        ) : (\r\n          `Subir ${files.length} archivo${files.length !== 1 ? \"s\" : \"\"}`\r\n        )}\r\n      </button>\r\n\r\n      {/* Resultados */}\r\n      {urls.length > 0 && (\r\n        <div>\r\n          <p className=\"mb-4 font-medium\">Archivos subidos:</p>\r\n          <div className=\"space-y-4\">\r\n            {urls.map((url, index) => (\r\n              <div key={index} className=\"p-4 bg-green-50 rounded-lg border border-green-200\">\r\n                <Media url={url} />\r\n                <p>Urls: </p>\r\n                <div className=\"mt-2 p-2 bg-white rounded text-xs font-mono break-all max-w-full\">\r\n                  {url}\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}