{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/gaelc/Desktop/examenIngWeb/gael/gael/frontend/src/components/auth/AuthContext.ts"],"sourcesContent":["import { createContext } from \"react\";\r\nimport { AuthUser } from \"@/src/types/auth\";\r\n\r\nexport interface AuthContextType {\r\n  user: AuthUser | null;\r\n  token: string | null;\r\n  setUser: (user: AuthUser) => void;\r\n  setToken: (token: string) => void;\r\n  refreshUser: () => Promise<void>;\r\n  logout: () => void;\r\n}\r\n\r\nexport const AuthContext = createContext<AuthContextType | undefined>(undefined);\r\n"],"names":[],"mappings":";;;;AAAA;;AAYO,MAAM,4BAAc,IAAA,8KAAa,EAA8B"}},
    {"offset": {"line": 18, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/gaelc/Desktop/examenIngWeb/gael/gael/frontend/src/hooks/useAuth.ts"],"sourcesContent":["import { useContext } from \"react\";\r\nimport { AuthContext } from \"@/src/components/auth/AuthContext\";\r\n\r\nexport function useAuth() {\r\n  const context = useContext(AuthContext);\r\n\r\n  if (!context) {\r\n    throw new Error(\"useAuth must be used within an AuthProvider\");\r\n  }\r\n\r\n  return context;\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;;AAEO,SAAS;;IACd,MAAM,UAAU,IAAA,2KAAU,EAAC,0JAAW;IAEtC,IAAI,CAAC,SAAS;QACZ,MAAM,IAAI,MAAM;IAClB;IAEA,OAAO;AACT;GARgB"}},
    {"offset": {"line": 43, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/gaelc/Desktop/examenIngWeb/gael/gael/frontend/src/components/ui/Navbar.tsx"],"sourcesContent":["\"use client\"\r\nimport Link from \"next/link\"\r\nimport { usePathname } from \"next/navigation\"\r\nimport { useState } from \"react\"\r\nimport { useAuth } from \"@/src/hooks/useAuth\"\r\n\r\nfunction Navbar() {\r\n  const { user, logout } = useAuth()\r\n  const pathname = usePathname()\r\n  const [isOpen, setIsOpen] = useState(false)\r\n\r\n  const closeDropdown = () => {\r\n    setIsOpen(false)\r\n  }\r\n\r\n  return (\r\n    <nav className=\"bg-slate-900/95 backdrop-blur-md shadow-lg sticky top-0 z-50 border-b border-slate-800\">\r\n      <div className=\"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8\">\r\n        <div className=\"flex items-center justify-between h-14\">\r\n          {/* Logo */}\r\n          <Link href=\"/\" className=\"text-xl font-bold text-white hover:text-purple-400 transition-colors\">\r\n            NextApp\r\n          </Link>\r\n          {/* Links condicionales */}\r\n          <div className=\"flex items-center space-x-6 mx-auto\">\r\n            {/* Sin login */}\r\n            {!user && (\r\n              <Link\r\n                href=\"/resources\"\r\n                className={`px-3 py-2 rounded-lg font-medium transition-all ${pathname === '/resources' ? 'bg-purple-600 text-white' : 'text-slate-300 hover:bg-slate-800 hover:text-white'}`}\r\n              >\r\n                Placeholder\r\n              </Link>\r\n            )}\r\n            {/* Con login */}\r\n            {user && (\r\n              <div>\r\n                \r\n                <Link\r\n                  href=\"/resources\"\r\n                  className={`px-3 py-2 rounded-lg font-medium transition-all ${pathname === '/resources' ? 'bg-purple-600 text-white' : 'text-slate-300 hover:bg-slate-800 hover:text-white'}`}\r\n                >\r\n                  Placeholder\r\n                </Link>\r\n\r\n                 <Link\r\n                  href=\"/giras\"\r\n                  className={`px-3 py-2 rounded-lg font-medium transition-all ${\r\n                    pathname === \"/giras\"\r\n                      ? \"bg-purple-600 text-white\"\r\n                      : \"text-slate-300 hover:bg-slate-800 hover:text-white\"\r\n                  }`}\r\n                >\r\n                  Giras\r\n                </Link>\r\n\r\n                <Link\r\n                  href=\"/conciertos\"\r\n                  className={`px-3 py-2 rounded-lg font-medium transition-all ${\r\n                    pathname === \"/conciertos\"\r\n                      ? \"bg-purple-600 text-white\"\r\n                      : \"text-slate-300 hover:bg-slate-800 hover:text-white\"\r\n                  }`}\r\n                >\r\n                  Conciertos\r\n                </Link>\r\n                <Link\r\n                  href=\"/reservas\"\r\n                  className={`px-3 py-2 rounded-lg font-medium transition-all ${\r\n                    pathname === \"/reservas\"\r\n                      ? \"bg-purple-600 text-white\"\r\n                      : \"text-slate-300 hover:bg-slate-800 hover:text-white\"\r\n                  }`}\r\n                >\r\n                  Mis reservas\r\n                </Link>\r\n\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          <div className=\"flex items-center\">\r\n            {user ? (\r\n              <div className=\"relative\">\r\n                {/* Avatar */}\r\n                <button\r\n                  onClick={() => setIsOpen(!isOpen)}\r\n                  className=\"flex items-center p-1.5 hover:bg-slate-800 rounded-lg transition-colors\"\r\n                >\r\n                  <img\r\n                    src={user.fotoPerfil || \"/default-avatar.png\"}\r\n                    alt={user.nombre}\r\n                    className=\"w-9 h-9 rounded-full ring-2 ring-purple-500/50 hover:scale-105 transition-transform\"\r\n                  />\r\n                </button>\r\n\r\n                {/* Desplegable */}\r\n                {isOpen && (\r\n                  <div className=\"absolute right-0 mt-2 w-50 bg-white/95 backdrop-blur-sm rounded-xl shadow-xl border border-slate-200 z-50 animate-in slide-in-from-top-2\">\r\n                    {/* Perfil */}\r\n                    <div className=\"py-1\">\r\n                      <Link\r\n                        href=\"/profile\"\r\n                        className=\"flex items-center px-4 py-2.5 text-gray-700 hover:bg-slate-100 transition-colors w-full\"\r\n                        onClick={closeDropdown}\r\n                      >\r\n                        Perfil\r\n                      </Link>\r\n                    </div>\r\n                    {/* Cerrar sesion */}\r\n                    <div className=\"border-t border-slate-100\">\r\n                      <button\r\n                        onClick={() => {\r\n                          logout()\r\n                          closeDropdown()\r\n                        }}\r\n                        className=\"w-full flex items-center px-4 py-2.5 text-red-600 hover:bg-red-50 font-medium transition-colors\"\r\n                      >\r\n                        Cerrar Sesi√≥n\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            ) : (\r\n              <a\r\n                href={\"/login\"}\r\n                className=\"px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white font-medium rounded-lg transition-colors\"\r\n              >\r\n                Iniciar Sesi√≥n\r\n              </a>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </nav>\r\n  )\r\n}\r\n\r\nexport default Navbar\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;;;AAJA;;;;;AAMA,SAAS;;IACP,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE,GAAG,IAAA,qIAAO;IAChC,MAAM,WAAW,IAAA,oJAAW;IAC5B,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,yKAAQ,EAAC;IAErC,MAAM,gBAAgB;QACpB,UAAU;IACZ;IAEA,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC;YAAI,WAAU;sBACb,cAAA,6LAAC;gBAAI,WAAU;;kCAEb,6LAAC,0KAAI;wBAAC,MAAK;wBAAI,WAAU;kCAAuE;;;;;;kCAIhG,6LAAC;wBAAI,WAAU;;4BAEZ,CAAC,sBACA,6LAAC,0KAAI;gCACH,MAAK;gCACL,WAAW,CAAC,gDAAgD,EAAE,aAAa,eAAe,6BAA6B,sDAAsD;0CAC9K;;;;;;4BAKF,sBACC,6LAAC;;kDAEC,6LAAC,0KAAI;wCACH,MAAK;wCACL,WAAW,CAAC,gDAAgD,EAAE,aAAa,eAAe,6BAA6B,sDAAsD;kDAC9K;;;;;;kDAIA,6LAAC,0KAAI;wCACJ,MAAK;wCACL,WAAW,CAAC,gDAAgD,EAC1D,aAAa,WACT,6BACA,sDACJ;kDACH;;;;;;kDAID,6LAAC,0KAAI;wCACH,MAAK;wCACL,WAAW,CAAC,gDAAgD,EAC1D,aAAa,gBACT,6BACA,sDACJ;kDACH;;;;;;kDAGD,6LAAC,0KAAI;wCACH,MAAK;wCACL,WAAW,CAAC,gDAAgD,EAC1D,aAAa,cACT,6BACA,sDACJ;kDACH;;;;;;;;;;;;;;;;;;kCAQP,6LAAC;wBAAI,WAAU;kCACZ,qBACC,6LAAC;4BAAI,WAAU;;8CAEb,6LAAC;oCACC,SAAS,IAAM,UAAU,CAAC;oCAC1B,WAAU;8CAEV,cAAA,6LAAC;wCACC,KAAK,KAAK,UAAU,IAAI;wCACxB,KAAK,KAAK,MAAM;wCAChB,WAAU;;;;;;;;;;;gCAKb,wBACC,6LAAC;oCAAI,WAAU;;sDAEb,6LAAC;4CAAI,WAAU;sDACb,cAAA,6LAAC,0KAAI;gDACH,MAAK;gDACL,WAAU;gDACV,SAAS;0DACV;;;;;;;;;;;sDAKH,6LAAC;4CAAI,WAAU;sDACb,cAAA,6LAAC;gDACC,SAAS;oDACP;oDACA;gDACF;gDACA,WAAU;0DACX;;;;;;;;;;;;;;;;;;;;;;iDAQT,6LAAC;4BACC,MAAM;4BACN,WAAU;sCACX;;;;;;;;;;;;;;;;;;;;;;;;;;;AASf;GAnIS;;QACkB,qIAAO;QACf,oJAAW;;;KAFrB;uCAqIM"}},
    {"offset": {"line": 265, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/gaelc/Desktop/examenIngWeb/gael/gael/frontend/src/components/auth/AuthProvider.tsx"],"sourcesContent":["// src/components/auth/AuthProvider.tsx\r\n\"use client\";\r\n\r\nimport { ReactNode, useEffect, useState, useCallback } from \"react\";\r\nimport { AuthContext } from \"./AuthContext\";\r\nimport { AuthUser } from \"@/src/types/auth\";\r\n\r\nexport function AuthProvider({ children }: { children: ReactNode }) {\r\n  const [user, setUser] = useState<AuthUser | null>(null);\r\n  const [token, setToken] = useState<string | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  const refreshUser = useCallback(async () => {\r\n    try {\r\n      const storedToken = localStorage.getItem(\"token\");\r\n      if (!storedToken) {\r\n        setUser(null);\r\n        return;\r\n      }\r\n\r\n      const response = await fetch(\"http://localhost:8080/api/auth/me\", {\r\n        headers: {\r\n          Authorization: `Bearer ${storedToken}`,\r\n        },\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error(\"Invalid token\");\r\n      }\r\n\r\n      const data = await response.json();\r\n      if (data.authenticated && data.user) {\r\n        setUser(data.user);\r\n        console.log(\"‚úÖ Usuario cargado:\", data.user.nombre);\r\n      } else {\r\n        throw new Error(\"No user data\");\r\n      }\r\n    } catch (error) {\r\n      console.error(\"‚ùå Error refreshUser:\", error);\r\n      setUser(null);\r\n      localStorage.removeItem(\"token\");\r\n      setToken(null);\r\n    }\r\n  }, []); // ‚úÖ SIN dependencias = se ejecuta UNA SOLA VEZ\r\n\r\n  const saveToken = (newToken: string) => {\r\n    console.log(\"üíæ Guardando token\");\r\n    setToken(newToken);\r\n    localStorage.setItem(\"token\", newToken);\r\n    \r\n    // Verificar inmediatamente\r\n    refreshUser();\r\n  };\r\n\r\n  const logout = () => {\r\n    console.log(\"üö™ Logout\");\r\n    setUser(null);\r\n    setToken(null);\r\n    localStorage.removeItem(\"token\");\r\n  };\r\n\r\n  // ‚úÖ useEffect UNA SOLA VEZ al montar componente\r\n  useEffect(() => {\r\n    console.log(\"üîÑ Inicializando auth...\");\r\n    const savedToken = localStorage.getItem(\"token\");\r\n    \r\n    if (savedToken) {\r\n      console.log(\"üì± Token encontrado, verificando...\");\r\n      refreshUser();\r\n    } else {\r\n      console.log(\"‚ùå Sin token\");\r\n      setUser(null);\r\n    }\r\n    \r\n    setLoading(false);\r\n  }, [refreshUser]); // ‚úÖ Solo refreshUser (estable)\r\n\r\n  // Pantalla de carga\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100\">\r\n        <div className=\"text-center p-8 bg-white rounded-2xl shadow-xl\">\r\n          <div className=\"w-16 h-16 border-4 border-blue-200 border-t-blue-500 rounded-full animate-spin mx-auto mb-4\"></div>\r\n          <h2 className=\"text-2xl font-bold text-gray-800 mb-2\">Iniciando...</h2>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <AuthContext.Provider value={{ \r\n      user, \r\n      token, \r\n      setUser, \r\n      setToken: saveToken, \r\n      refreshUser, \r\n      logout \r\n    }}>\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAGA;AACA;;;AAJA,uCAAuC;AACvC;;;AAMO,SAAS,aAAa,EAAE,QAAQ,EAA2B;;IAChE,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAkB;IAClD,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAgB;IAClD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IAEvC,MAAM,cAAc,IAAA,4KAAW;iDAAC;YAC9B,IAAI;gBACF,MAAM,cAAc,aAAa,OAAO,CAAC;gBACzC,IAAI,CAAC,aAAa;oBAChB,QAAQ;oBACR;gBACF;gBAEA,MAAM,WAAW,MAAM,MAAM,qCAAqC;oBAChE,SAAS;wBACP,eAAe,CAAC,OAAO,EAAE,aAAa;oBACxC;gBACF;gBAEA,IAAI,CAAC,SAAS,EAAE,EAAE;oBAChB,MAAM,IAAI,MAAM;gBAClB;gBAEA,MAAM,OAAO,MAAM,SAAS,IAAI;gBAChC,IAAI,KAAK,aAAa,IAAI,KAAK,IAAI,EAAE;oBACnC,QAAQ,KAAK,IAAI;oBACjB,QAAQ,GAAG,CAAC,sBAAsB,KAAK,IAAI,CAAC,MAAM;gBACpD,OAAO;oBACL,MAAM,IAAI,MAAM;gBAClB;YACF,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,wBAAwB;gBACtC,QAAQ;gBACR,aAAa,UAAU,CAAC;gBACxB,SAAS;YACX;QACF;gDAAG,EAAE,GAAG,+CAA+C;IAEvD,MAAM,YAAY,CAAC;QACjB,QAAQ,GAAG,CAAC;QACZ,SAAS;QACT,aAAa,OAAO,CAAC,SAAS;QAE9B,2BAA2B;QAC3B;IACF;IAEA,MAAM,SAAS;QACb,QAAQ,GAAG,CAAC;QACZ,QAAQ;QACR,SAAS;QACT,aAAa,UAAU,CAAC;IAC1B;IAEA,gDAAgD;IAChD,IAAA,0KAAS;kCAAC;YACR,QAAQ,GAAG,CAAC;YACZ,MAAM,aAAa,aAAa,OAAO,CAAC;YAExC,IAAI,YAAY;gBACd,QAAQ,GAAG,CAAC;gBACZ;YACF,OAAO;gBACL,QAAQ,GAAG,CAAC;gBACZ,QAAQ;YACV;YAEA,WAAW;QACb;iCAAG;QAAC;KAAY,GAAG,+BAA+B;IAElD,oBAAoB;IACpB,IAAI,SAAS;QACX,qBACE,6LAAC;YAAI,WAAU;sBACb,cAAA,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;;;;;;kCACf,6LAAC;wBAAG,WAAU;kCAAwC;;;;;;;;;;;;;;;;;IAI9D;IAEA,qBACE,6LAAC,0JAAW,CAAC,QAAQ;QAAC,OAAO;YAC3B;YACA;YACA;YACA,UAAU;YACV;YACA;QACF;kBACG;;;;;;AAGP;GA9FgB;KAAA"}}]
}